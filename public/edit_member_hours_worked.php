<?php require_once("../includes/session.php"); ?><?php require_once("../includes/db_connection.php"); ?><?php require_once("../includes/functions.php"); ?><?php require_once("../includes/validation_functions.php"); ?><?php     // use the function ConfirmLoggedIn to see if the current user        // is allowed to view this page    ConfirmLoggedIn();?><?php    $User = FindMemberById($_SESSION["MemberId"]);        // Check to see if the current user can edit members.    // If not, then the user cannot have access to this page.    if($User["EditMembers"] == 0) {        RedirectTo("index.php");    }?><?php  $MemberHoursWorked = FindMemberHoursWorkedById($_GET["hoursworkedid"]);  if (!$MemberHoursWorked) {    // page ID was missing or invalid or     // page couldn't be found in database    RedirectTo("view_member_hours_worked.php?id=" . urlencode($_GET["id"]));  }    $Member = FindMemberById($_GET["id"]);?><?phpif (isset($_POST['submit'])) {    // Process the form    // validations    $required_fields = array("Date", "NumberOfHours");      ValidatePresences($required_fields);    ValidateDate($_POST["Date"]);  if (empty($errors)) {    // Perform Update    $HoursWorkedId = $MemberHoursWorked["HoursWorkedId"];        // Convert a date string into a Unix date.    $ModifiedDate = strtotime($_POST["Date"]);    // Convert a Unix date into a MySQL format date.    $Date = date('Y-m-d H:i:s', $ModifiedDate);        $NumberOfHours = $_POST["NumberOfHours"];                    $query  = "UPDATE HoursWorked SET ";    $query .= "NumberOfHours = {$NumberOfHours}, ";    $query .= "Date = '{$Date}' ";    $query .= "WHERE HoursWorkedId = {$HoursWorkedId} ";    $query .= "LIMIT 1";    $result = mysqli_query($connection, $query);    if ($result == 1) {      // Success      $_SESSION["message"] = "Hours Worked updated.";      RedirectTo("view_member_hours_worked.php?id=" . urlencode($Member["MemberId"]));    } else {      // Failure      $_SESSION["message"] = "Hours Worked update failed.";    }  }} else {  // This is probably a GET request} // end: if (isset($_POST['submit']))?><?php $layout_context = "admin"; ?><?php include("../includes/layouts/header.php"); ?><div id="main">  <div id="navigation">    &nbsp;  </div>  <div id="page">    <?php echo message(); ?>    <?php echo FormErrors($errors); ?>    <h2>Edit Member: <?php echo htmlentities($Member["FirstName"]) . " " . htmlentities($Member["LastName"]); ?></h2>    <form action="edit_member_hours_worked.php?id=<?php echo urlencode($Member["MemberId"]); ?>&hoursworkedid=<?php echo urlencode($MemberHoursWorked["HoursWorkedId"]); ?>" method="post">                <p>Date:                    <?php // Convert a MySQL Date into United State format mm/dd/yyyy                    $Date = strtotime(htmlentities($MemberHoursWorked["Date"]));                     $FormatedDate = date("m/d/Y", $Date); ?>                    <input type="text" name="Date" value="<?php echo $FormatedDate; ?>" />Enter Date in mm/dd/yyyy format                      </p>                      <p>Number of Hours Worked:                    <input type="text" name="NumberOfHours" value="<?php echo htmlentities($MemberHoursWorked["NumberOfHours"]); ?>" />                      </p>      <input type="submit" name="submit" value="Save Changes" />    </form>    <br />    <a href="view_member_hours_worked.php?id=<?php echo urlencode($Member["MemberId"]); ?>">View Member Hours</a>  </div></div><?php include("../includes/layouts/footer.php"); ?>